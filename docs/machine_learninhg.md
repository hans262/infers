Machine Learning
======================================
机器学习这个词在几年前确实有点超前，人们往往无法把它和生活所结合起来，但在当今社会如果你是一个细心观察的人，你会发现机器学习已经无处不在。
例如：
- google的新闻聚类，google每天收集大量的新闻，对具有相同特征的新闻进行分簇；
- 游戏中对非常坑的队友人身攻击，会被文字模型预测为人身攻击，从而禁止你输出；
- 直播平台的弹幕自动被视频当前人像隐藏，利用人像关键点识别，即可抓取人像出现的坐标点；
- 等等～

机器学习是人工智能的一个发展方向，机器学习和深度学习都属于人工智能的一个子集。

机器学习分为以下三种方式：
- 监督学习
- 无监督学习
- 强化学习

## 什么是机器学习？
Arthur Samuel (1959): 在没有明确设定的情况下，使计算机具有学习能力的研究领域。

Tom Mitchell (1998): 计算机程序从经验E中学习，解决某一任务T进行某一性能度量P，通过P测定在T上的表现因经验E而提高。

李宏毅：机器学习就是让机器自己找函式。往往这样的函式我们很难实现，这时候就可以通过机器学习给我找出函式。
- function(音频) -> 文字
- function(图片) -> 分类

## 监督学习 Supervised learning
根据已有的数据集，已知输入和输出结果之间的关系，根据这种关系训练得到一个最优的模型，该过程也就是监督学习。也就是说，在监督学习中训练数据既有特征（输入）又有标签（输出），通过训练学习，让机器可以自己找出特征和标签之间的联系，在面对只有特征没有标签的数据时，可以判断初标签。

监督学习的分类：
- **回归（Regression）**：准确来说就是对训练数据进行分析，拟合出适当的函数模型y=f(x)，回归问题多用来预测一个具体的值。
- **分类（Classification）**：分类问题一般用来预测离散值输出，输出是有限的。例如根据特征预测男女，预测衣服尺寸，预测肿瘤良性还是恶性。

<*>人脸识别是分类还是回归问题？人脸识别是一个分类问题。

## 无监督学习 Unsupervised learning
当缺乏足够的先验知识，难以人工的标注特征和标签或进行人工标注的成本太高，我们希望计算机来完成这些工作。也就是说，根据没有标签的训练数据来进行训练，称之为无监督学习。

无监督学习典型的例子是聚类。其目的是把相似的东西聚在一起，我们不关心这一类是什么，因此聚类算法通常只需要知道如何计算相似度就可以开始工作了。

- google的新闻整合，对大量的新闻进行分簇，把具有相似特征的新闻分到一起。
- 根据给定基因数据，对DNA数据进行分簇。

## 线性回归模型 Linear Regression
在数学中，表示两种或两种以上变量间相互依赖的关系，其表达式为y = wx + b，b为误差服从均值为0的正态分布。

在机器学习中，通过一组训练数据根据特征和标签之间的关系来拟合一条直线，该直线就是一个线性回归模型，通过该模型可以根据特征预测其标签。

用一元二次方程表示 -> y = w*x + b，自变量y随因变量x的改变而改变，通过大量的已知数据{x, y}求导w和b的值，当我们输入一个新的x时能预测其y。

怎么才能让表达式更加准确呢，也就是说让该模型的预测越来越准确，我们需要计算每次输出结果的损失，当损失的均值越来越趋近于0的时候，我们也就可以说该模型已经是理想状态最好的了。


## 我对于机器学习的解释
生活中有很多机器学习的例子，人们往往对机器学习充满一种神秘感。
机器学习是基于预测衍生出的一门学科，基于过去的历史数据预测未来会发生的事情。
机器学习是通过模拟人类大脑行为，来创建一种计算机程序，使该程序拥有预测、识别的能力。

人类的大脑就是一个机器学习'模型'，这个模型可以对任何物体做识别和分类，只需要通过视觉、听觉、味觉系统去接受该物体的特征信息，然后大脑给出预测结果。这个模型我们可以把它理解为一个黑箱，我们不需要去管它是如何对物体进行分类的，只需要输入历史数据就行了，通过不断的学习来提高预测的准确率，已达到人类所能接受的一个拟合值。

模型的学习过程也就是拟合出一条完美的曲线，曲线的维度由特征的数量来决定，当我们输入特征可以通过曲线找到对应的标签。

在计算机中是如何创建一个模型呢？
这里讲解最简单的模型结构‘全连接神经网络’
将模型分层，模型的第一层也就是输入端，最后一层也就是输出端，每一层由多个神经元组成，每一个神经元携带一个权重值来参与计算，每一层神经元到下一层神经元的计算方式都是预先设计好的，当一个模型被初始化好后，会训练该模型，训练的过程也就是修改每一个神经元权重的过程。

### 如何训练模型
当一个模型被初始化好之后，我们会对模型进行训练，让他更加完美的拟合历史数据。

1. 将所有样本数据拆分为`测试集`和`样本集`；
2. 将样本数据拆分为特征和标签，它们是一一对应的，特征对应着模型的输入标签对应这模型的输出；
3. 将特征值输入到模型得到输出，用输出和该特征的标签去计算神经网络最后一层的误差，通过该误差反向计算每一层神经元的误差，用误差去更新每一个神经元的权重；
4. 当更新完每一个神经元，这也就是单个训练样本训练一次模型的过程；
5. 计算一个整体误差 来校验模型的拟合完善程度；

### 如何评估一个模型训练好了呢？
我们需要一个值来衡量这个模型预测结果的准确度，这个值也就是`代价函数`求解，也称`损失函数`。说白了也就是计算模型基于样本数据的整体误差。在商业项目中可能会把样本数据划分为：训练数据、测试数据，用模型去计算测试数据的损失来评估模型较为专业。

代价函数：
```
  # 所有样本平均损失 用于表达该模型的整体拟合程度
  loss = 1 / 2 * m * ∑m(hy - ys) ** 2
  
  # 单个样本损失 用于单次梯度下降的误差计算
  loss = 1 / 2 * (hy - ys) ** 2

  # hy 该样本真实输出值
  # ys 该样本标签值
  # m 样本总数
```

## 假设函数
机器学习最终用来预测目标特征的输出函数，用数学表达式可表示为：

H(x) = θ0 + Θ1 * X

这也是一个简单的线性回归模型，该模型中又两个模型参数(θ0, θ1)，是最简单的线性回归模型。

### 一些疑问
有人会说机器学习既然是基于历史数据去预测，那预测房价和天气当然就是不可能准确的了，机器学习既然不准确那研究的意义是什么呢？

预测未来为什么不准确，那是因为未来的数据变化太多，可能那种特征的数据还没有被模型所学习过。
机器学习是在模拟大脑的学习过程，人类的预测过程是否都是完全准确的呢，这是一个慢性学习过程，当有足够多的训练样本，那么其准确率是无限趋近于完美的。

# 梯度下降法
一种按照步长迭代的方式来寻找代价函数最小值求解，并不断修改模型权重参数，越靠近极小值时收敛速度减慢，这样的过程称之为梯度下降法。
梯度下降是一种训练神经网络模型的方式，是用来更新模型中权重和偏置参数。

直接给出公式:
```
  # 权重的更新
  - w' = w - α * (∂J / ∂w)
  # 偏值更新
  - b' = b - α * (∂J / ∂hy)

  # α 学习率
  # ∂J / ∂w 代价函数相对于当前权重的导数
  # ∂J / ∂hy 代价函数相对于当前神经元输出的导数
```
如果定义代价函数为:
```
  J = (1 / 2) * (hy - ys) ** 2
```
向前传播计算过程:
```
  hy = xs * w + b
```
下面给出w和hy的求导过程：
```
  (∂J / ∂hy) = hy - ys
  (∂J / ∂w) = (∂J / ∂hy) * xs = hy - ys
```